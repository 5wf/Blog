---
layout: post
title: "Claims in .NET 4.5 – Definiert in mehreren Namenspaces?"
date: 2013-03-14 01:03
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [Claims]
---
<p>Bei einer Umstellung von einer .NET 4.0 Anwendung, welche unter anderem auch die <a href="http://msdn.microsoft.com/en-us/security/aa570351.aspx">Windows Identity Foundation</a> benutzt, auf .NET 4.5 ist mir aufgefallen dass der Typ “Claim” unter Umständen in drei Namespaces definiert sein kann:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1789.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb943.png" width="524" height="155"></a> </p> <p><strong>Die 3 Namespaces mit den Claim</strong></p> <p>Seit .NET 4.5 gibt es Claims in diesen zwei Namenspaces:</p> <p><a href="http://msdn.microsoft.com/en-us/library/system.security.claims.claim.aspx">System.Security.Claims.Claim</a></p> <p><a href="http://msdn.microsoft.com/en-us/library/ms572956(v=vs.110)">System.IdentityModel.Claims.Claim</a></p> <p>Unter umständen (wenn die Referenz Microsoft.IdentityModel.dll noch im Projekt ist) hat man noch dies zur Auswahl:</p> <p><a href="http://msdn.microsoft.com/en-us/library/microsoft.identitymodel.claims.claim.aspx">Microsoft.IdentityModel.Claims</a></p> <p><strong>Erkläuterung:</strong></p> <p>Das <a href="http://en.wikipedia.org/wiki/Claims-based_identity">Konzept der Claims</a> wurde mit .NET 4.5 direkt ins Framework eingebunden. Daher gibt es auch einige Interfaces, wie z.B. IClaimsIdentity, nicht mehr. Der Artikel “<a href="http://msdn.microsoft.com/en-us/library/hh873305.aspx">What’s New in Windows Identity Foundation 4.5</a>” listet alles genauer auf. Die <u>Microsoft.IdentityModel.*</u> Namespaces sind damit <u>veraltet</u>. </p> <p>Wichtigste Parts meiner Meinung nach:</p> <p><em><strong>WIF Is Now Part of the .NET Framework</strong></em></p> <p><em>W</em><em>IF classes are now spread across several assemblies, the main ones being mscorlib, System.IdentityModel, System.IdentityModel.Services, and System.ServiceModel. Likewise, the WIF classes are spread across several namespaces: </em><a href="http://msdn.microsoft.com/en-us/library/system.security.claims.aspx"><em>System.Security.Claims</em></a><em>, several </em><a href="http://go.microsoft.com/fwlink/?LinkId=272004"><em>System.IdentityModel</em></a><em> namespaces, and </em><a href="http://msdn.microsoft.com/en-us/library/system.servicemodel.security.aspx"><em>System.ServiceModel.Security</em></a><em>. The</em><a href="http://msdn.microsoft.com/en-us/library/system.security.claims.aspx"><em>System.Security.Claims</em></a><em> namespace contains the new </em><a href="http://msdn.microsoft.com/en-us/library/system.security.claims.claimsprincipal.aspx"><em>ClaimsPrincipal</em></a><em> and </em><a href="http://msdn.microsoft.com/en-us/library/system.security.claims.claimsidentity.aspx"><em>ClaimsIdentity</em></a><em> classes (see below). All principals in .NET now derive from </em><a href="http://msdn.microsoft.com/en-us/library/system.security.claims.claimsprincipal.aspx"><em>ClaimsPrincipal</em></a><em>. For more detailed information about the WIF namespaces and the kinds of classes that they contain, see </em><a href="http://msdn.microsoft.com/en-us/library/jj729788.aspx"><em>WIF API Reference</em></a><em>. For information about how namespaces map between WIF 3.5 and WIF 4.5, see </em><a href="http://msdn.microsoft.com/en-us/library/jj157091.aspx"><em>Namespace Mapping between WIF 3.5 and WIF 4.5</em></a><em>.</em></p> <blockquote> <p><font color="#545454" face="Lucida Sans Unicode"><em><strong>New Claims Model and Principal Object</strong></em></font></p></blockquote> <p><em>Claims are at the very core of the .NET Framework 4.5. The base claim classes (Claim, ClaimsIdentity, ClaimsPrincipal, ClaimTypes, and ClaimValueTypes) all live directly in mscorlib in the System.Security.Claims namespace. It is no longer necessary to use interfaces in order to plug claims into the .NET identity system: WindowsPrincipal, GenericPrincipal, and RolePrincipal now inherit from ClaimsPrincipal; and WindowsIdentity, GenericIdentity, and FormsIdentity now inherit from ClaimsIdentity. In short, every principal class will now serve claims. The WIF 3.5 integration classes and interfaces (WindowsClaimsIdentity, WindowsClaimsPrincipal, IClaimsPrincipal, IClaimsIdentity) have thus been removed. In addition, the ClaimsIdentity class now exposes methods which make it easier to query the identity’s claims collection.</em></p> <p><strong>Migration auf Windows Identity Foundation 4.5</strong></p> <p>Wer eine Anwendung migriert, der schaut am besten in der <a href="http://msdn.microsoft.com/en-us/library/jj157091.aspx">Mapping Tabelle</a> nach. </p> <p>Wenn im Code diese Klassen “WindowsClaimsIdentity, WindowsClaimsPrincipal, IClaimsPrincipal,IClaimsIdentity” vorkommen, dann kann man es meist sehr einfach mit ClaimsPrinciple bzw. ClaimsIdentity austauschen.</p> <p>Ansonsten ist die hauptsächliche Claim-Definition im <a href="http://msdn.microsoft.com/en-us/library/system.security.claims.claim.aspx">System.Security.Claims</a> Namespace! </p>
