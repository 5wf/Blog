---
layout: post
title: "Performance von Websites & Browser “Reflows”"
date: 2011-06-21 01:10
author: robert.muehsig
comments: true
categories: [Allgemein]
tags: [Browser, HTML5, Performance, Reflows, Web]
---
<p>Über ein <a href="http://www.youtube.com/watch?v=q_O9_C2ZjoA&amp;feature=player_embedded">Web-Performance Video von Paul Irish</a> (der Schöpfer des <a href="http://html5boilerplate.com/">HTML5 Boilerplate</a>) bin ich auf das Thema “Reflows” aufmerksam geworden und fand es ganz interessant, auch wenn wahrscheinlich diese Performance-Optimierung eher zur Sorte “Cutting-Edge” gehört <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-winkingsmile" alt="Zwinkerndes Smiley" src="{{BASE_PATH}}/assets/wp-images/wlEmoticon-winkingsmile1.png">&nbsp;</p> <p><strong>Was ist ein “Reflow”?</strong></p> <p>Der “Reflow” ist der Prozess in dem der Brower die einzelnen Elemente positioniert und rendert. Jedes Element des DOM Trees muss überprüft werden, ob es gerendert werden muss oder nicht. Um diesen Prozess zu veranschaulichen wird in diesem Video der Seitenaufbau von Google genauer dargestellt – man sieht deutlich die “Elemente” und Rendering-Schritte bis zur fertigen Seite:</p> <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:673f18e0-9bd6-43ca-9313-42c326d7bf4f" class="wlWriterEditableSmartContent"><div><object width="448" height="252"><param name="movie" value="http://www.youtube.com/v/nJtBUHyNBxs?hl=en&amp;hd=1"></param><embed src="http://www.youtube.com/v/nJtBUHyNBxs?hl=en&amp;hd=1" type="application/x-shockwave-flash" width="448" height="252"></embed></object></div></div> <p><strong>“Schlechtes Beispiel”</strong></p> <p>Im oberen Video hat man gesehen, dass alle Elemente von Anfang an eigentlich “ordentlich” positioniert sind, als schlechteres Beispiel dient (oder diente?) die Mozilla Website. Aber der Sekunde 10 wird das eigentlich fertige Raster nochmal neu angeordnet – in diesem Fall wird ein Großteil der Seite nochmal gerendert, was das Rendering natürlich verlangsamt:</p> <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:101fed0a-67b6-4210-9a22-746b946d5fae" class="wlWriterEditableSmartContent"><div><object width="448" height="252"><param name="movie" value="http://www.youtube.com/v/ZTnIxIA5KGw?hl=en&amp;hd=1"></param><embed src="http://www.youtube.com/v/ZTnIxIA5KGw?hl=en&amp;hd=1" type="application/x-shockwave-flash" width="448" height="252"></embed></object></div></div> <p>&nbsp;</p> <p>Ein weiteres Beispiel wäre noch die <a href="http://www.youtube.com/watch?v=dndeRnzkJDU">Wikipedia S</a></p> <p><strong>Was stößt einen Reflow an?</strong></p> <p>Im Grunde ist es logisch, dass der Browser die Seite neu rendern muss, wenn ich DOM Elemente manipuliere oder neue Elemente einfüge. Insbesondere wenn man via Javascript die DOM manipuliert, kann man aber einiges “falsch” machen.</p> <p><a href="http://www.youtube.com/watch?v=dndeRnzkJDU">eite</a>.</p> <p><strong>Was sollte man machen um unnötige Reflows zu vermeiden?</strong></p> <p>Einige allgemeine <a href="http://code.google.com/intl/de-DE/speed/articles/reflow.html">Hinweise gibt es von Google</a>:</p> <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:54524377-6f59-41b7-a8a5-1fefab750492" class="wlWriterEditableSmartContent"><div><object width="448" height="252"><param name="movie" value="http://www.youtube.com/v/ZHxbs5WEQzE?hl=en&amp;hd=1"></param><embed src="http://www.youtube.com/v/ZHxbs5WEQzE?hl=en&amp;hd=1" type="application/x-shockwave-flash" width="448" height="252"></embed></object></div></div>   <ol> <li>"Reduce unnecessary DOM depth. Changes at one level in the DOM tree can cause changes at every level of the tree - all the way up to the root, and all the the way down into the children of the modified node. This leads to more time being spent performing reflow.</li> <li>Minimize CSS rules, and remove unused CSS rules.</li> <li>If you make complex rendering changes such as animations, do so out of the flow. Use position-absolute or position-fixed to accomplish this.</li> <li>Avoid unnecessary complex CSS selectors - descendant selectors in particular - which require more CPU power to do selector matching.</li></ol> <p>&nbsp;</p> <p>Auch auf der <a href="http://dev.opera.com/articles/view/efficient-javascript/?page=3#reflow">Opera Developer Seite sind einige Tipps aufgeschlüsselt</a>.</p> <p>Häufigster “Fehltritt”: Wenn man ein DOM verändert und hinterher z.B. den offset des Elements beziehen möchte macht der Browser <strong><u>2</u></strong> “reflows” – jegliches Messen von “Größen/Werten” stößt diesen Prozess an. Auch bei einer Manipulation bietet es sich an, dass Element zu clonen und jegliche Operationen auf dem “unsichtbaren” Clone durchzuführen und erst am Ende das Element mit dem Original zu ersetzen.</p> <p>Weitere <a href="http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/">gute Tipps zu dem Thema findet ihr hier</a>.</p> <p><strong>Woran erkenne ich Reflows?</strong></p> <p>Man kann es z.B. in den Chrome Developer Tools sehen: Bei “Recalculate Style” findet ein Reflow statt – ob und inwiefern das “böse” ist, muss man genauer anschauen, allerdings kann man z.B. bei der DOM Manipulierung via Javascript sicherlich ein paar Sachen besser machen <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smiley" src="{{BASE_PATH}}/assets/wp-images/wlEmoticon-smile1.png"></p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1285.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb467.png" width="535" height="338"></a></p> <p><strong>TL;DR – Linkliste</strong></p> <p>- <a href="http://code.google.com/intl/de-DE/speed/articles/reflow.html">Google Speed Seite zum Thema</a></p> <p>- <a href="http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/">Opera Seite mit Tipps für DOM Manipulation</a></p> <p>- <a href="http://www.mozilla.org/newlayout/doc/reflow.html">Mozilla Seite mit Tipps</a></p> <p>- <a href="http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/">Noch eine Seite mit Tipps</a></p> <p><strong>Mehr über Web-Performance?</strong></p> <p>In dem Video von Paul Irish gibt es noch weitere interessante Tipps zum Thema Web Tuning:</p> <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:154bb704-bbb9-4452-812e-7489dd30d2fa" class="wlWriterEditableSmartContent"><div><object width="448" height="252"><param name="movie" value="http://www.youtube.com/v/q_O9_C2ZjoA?hl=en&amp;hd=1"></param><embed src="http://www.youtube.com/v/q_O9_C2ZjoA?hl=en&amp;hd=1" type="application/x-shockwave-flash" width="448" height="252"></embed></object></div></div>
