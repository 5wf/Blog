---
layout: post
title: "HowTo: Einstieg in Branching & Merging Strategien"
date: 2010-04-27 23:13
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [Branching, HowTo, Merging, Source, TFS]
---
<p><a href="{{BASE_PATH}}/assets/wp-images/image947.png"><img style="border-bottom: 0px; border-left: 0px; margin: 0px 10px 0px 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" align="left" src="{{BASE_PATH}}/assets/wp-images/image_thumb132.png" width="153" height="133" /></a> Wer ein <a href="http://en.wikipedia.org/wiki/Revision_control">Source Control Management</a> benutzt wird früher oder später an dem Punkt eines Releases kommen. Spätestens ab diesem Zeitpunkt muss man sich Gedanken machen, wie man den Quellcode nun am besten verwaltet. Branching &amp; Merging sind hier in dem Blogpost die Schlagwörter um die es gehen soll.</p> <!--more-->  <p><strong>Grundbegriffserklärung: Branching?</strong></p>  <p>Ein <a href="http://en.wikipedia.org/wiki/Branching_(software)">Branch</a> (dt. Zweig) ist eine quasi eine Kopie des IST Zustandes des Source Codes. So kann man z.B. 2 unterschiedliche "Entwicklungszweige” haben um verschiedene Sachen zu entwickeln - völlig voneinander losgelöst.</p>  <p><strong>Merging?</strong></p>  <p><a href="http://en.wikipedia.org/wiki/Merge_(revision_control)">Merging</a> ist genau die Umkehroperation des branchings. Wenn man aus einem Hauptzweig einen "Entwicklerzweig” abgespaltet hat, möchte man diesen auch irgendwann wieder in den Hauptzweig zurückführen. Diesen Vorgang nennt man mergen.</p>  <p><strong>Toolunterstützung</strong></p>  <p>Ich werde in diesem Blogpost nur die Theorie erklären, allerdings sind beide Vorgänge in mir jedem bekannten Source Control Management System irgendwie mit dabei. Das System kennt also die Verzweigungen. Dies ist wichtig damit das System beim Merging wieder unterstützt.</p>  <p>Ein guten Guide (besonders im Zusammenhang mit dem TFS) zum Thema Branching &amp; Merging befindet sich auf Codeplex.</p>  <p><strong>Branching Strategien: "Basic Branching”</strong></p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image948.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb133.png" width="525" height="199" /></a> </p>  <p></p>  <p>Das ist die simpelste Herangehensweise. Der Main-Pfad repräsentiert unser Hauptentwicklungszweig. Hierbei muss sichergestellt werden, dass man möglichst immer den Main-Zweig "stabil” lässt, sodass man theoretisch jederzeit ein neues Release rausgeben kann. Entwicklungsarbeiten würden nur im Development-Zweig gemacht. Am Ende einer Entwicklungsphase würde der Entwicklungszweig wieder in den Mainzweig "gemerged” und von dort aus wieder ein neuer Branch für einen neuen Release gezogen.</p>  <p><strong>Was erreichen wir dadurch?</strong></p>  <p>Man kann jedes Release nachvollziehen und die Entwicklung beeinträchtigt nicht den Mainzweig - was bei einem Hotfix z.B. wichtig wäre.</p>  <p><strong>"Standard Branch Plan”</strong></p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image949.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb134.png" width="515" height="236" /></a> </p>  <p>Dieses Vorgehensmodell könnte schon bei weniger komplexen Projekten ausreichen. Ziel ist es immer den Main Zweig absolut stabil zu halten.</p>  <p>Im Alltag wird man ein Entwicklungsprojekt X haben, welches nun z.B. in Version 1 released wurde. Nun gehen die Arbeiten für Version 1.5 im Entwicklungszweig gut voran, allerdings wurde ein Bug auf dem Live System gefunden. Direkt in dem Main Zweig den Bug zu finden und zu lösen kann Nebenwirkungen haben. Daher hat man noch einen "Service Pack” bzw. "Hotfix” Zweig. In diesem Zweig kann der Fehler gefunden werden und auch getestet werden. Wenn alles OK ist, kann man aus dem "Service Pack” bzw. "Hotfix” Zweig wieder nach Main mergen (also die Bugfixes nun auch im Main Zweig einchecken) und ein neues Release ausgeben.</p>  <p><strong>"Advanced Branch Plan”</strong></p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image950.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb135.png" width="513" height="288" /></a> </p>  <p></p>  <p></p>  <p></p>  <p>Hier wird noch zusätzlich ein direkter Hot Fix Zweig eingeführt. Dies kann man vielleicht ganz gut mit den Windows Service Packs und Hotfixes vergleichen. Kleinere Sachen werden in einem Hotfix Zweig gefixt. Der Hotfix wird dann weiter nach oben in den Service Pack Branch gemerged. Nachdem man einige Hotfixes gemacht hat kann man ein Service Pack rausgeben. In diversen Abständen sollten die Änderungen die im Service Pack Zweig sind natürlich auch wieder nach Main fliessen, damit man in der nächsten großen Version die alten Fehler nicht wieder drin hat.</p>  <p><strong>Der Development Zweig - "Branch per Feature”</strong></p>  <p>Diese drei Beispiele sind nur für die Produktivumgebungen wichtig gewesen. Für die Entwicklung kann man natürlich auch mehrere Entwicklungszweige anfangen. So kann man z.B. mehrere Entwicklungsteams getrennt voneinander arbeiten lassen oder man macht ein Branch für jedes Feature:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image951.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb136.png" width="525" height="278" /></a> </p>  <p>Jedes Entwicklungsteam kann für sich an einem Feature arbeiten. Nach einem gewissen Stand kann das Team auch für den Test einen eigenen Branch anlegen. </p>  <p>Egal wie komplex man es gestaltet. Der "Main” Zweig trennt die Entwicklung und das Produktivsystem. Man kann Änderungen die auf dem Produktivsystem gemacht wurden über den Hotfix -&gt; Service Pack -&gt; Main Zweig bis zu den diversen Development Branches durchreichen "Forward Integration” bzw. "Reverse Integration” sind hier die Stichwörter.</p>  <p><strong>Wie kann das z.B. im Source Control aussehen:</strong></p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image952.png"><img style="border-bottom: 0px; border-left: 0px; margin: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" align="left" src="{{BASE_PATH}}/assets/wp-images/image_thumb137.png" width="168" height="354" /></a> </p>  <p>Was vorher in den Bildchen schematisch erklärt wurde, kann im Explorer z.B. so aussehen. Dies ist in dem Fall der TFS Team Explorer. In der Version 2010 hat sich auch einiges in dem Gebiet getan. Als kleines Beispiel kann der TFS die Hierarchie sehr nett darstellen:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image953.png"><img style="border-bottom: 0px; border-left: 0px; margin: 0px 0px 0px 10px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb138.png" width="282" height="217" /></a> </p>  <p><strong>Weitere Ressourcen:</strong></p>  <p>Alle Bilder stammen aus dem <a href="http://tfsbranchingguideiii.codeplex.com/">Visual Studio TFS 2010 Branching Guide</a> - allerdings trifft die pure Theorie genauso z.B. auf SVN zu.</p>  <p>Ich versuche die verschiedenen Sachen in den nächsten Blogposts direkt mal mit einem TFS Projekt zu zeigen. Das Thema ist sehr groß und nicht mit einem Blogpost zu erschlagen. Hier ging es mir nur um die aller gröbsten Basics.</p>
