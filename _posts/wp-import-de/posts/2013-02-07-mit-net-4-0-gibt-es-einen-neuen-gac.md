---
layout: post
title: "Mit .NET 4.0 gibt es einen neuen GAC!?"
date: 2013-02-07 00:26
author: robert.muehsig
comments: true
categories: [Allgemein]
tags: [CLR]
language: de
---
{% include JB/setup %}
<p>Seit .NET 4.0 gibt es einen neuen Global Assembly Cache (GAC) welcher unter diesem Pfad zu finden ist:</p> <p><em>C:\Windows\Microsoft.NET\assembly</em></p> <p>Alle .NET 4.0 bzw. CLR 4.0 Applikationen nutzen diesen GAC.</p> <p><strong>Was ist mit dem "alten” GAC?</strong></p> <p>Den alten GAC gibt es nach wie vor unter diesem Pfad:</p> <p><em>C:\Windows\assembly</em></p> <p>Dieser ist nach wie vor für .NET 2.0 - .NET 3.5 bzw. CLR 2.0 Applikationen zuständig.</p> <p><strong>CLR? .NET Framework Version? Ist das nicht dasselbe?</strong></p> <p>Das Thema ist etwas komplexer, aber als Kurzfassung finde ich das ganz gut:</p> <p>CLR + Libraries = .NET Framework</p> <p>Wobei die <a href="http://en.wikipedia.org/wiki/Common_Language_Runtime">CLR</a> die Basis für die Ausführung ist. Mit diversen .NET Framework Versionen kamen mehr Libraries hinzu, jedoch gab es nur 2 große CLR Versionen bis heute – die Version 2.0 und 4.0.</p> <p><a href="http://blogs.msdn.com/b/karinm/archive/2008/11/11/what-s-the-difference-between-clr-and-net-framework.aspx"><em>Quelle</em></a></p> <p><strong>Warum gab es diese Änderung?</strong></p> <p>An dieser Stelle möchte ich direkt meine Quelle benennen: <a href="http://stackoverflow.com/questions/2660355/net-4-0-has-a-new-gac-why">Stackoverflow</a></p> <p><em>“In .NET Framework 4.0, the GAC went through a few changes. The GAC was split into two, one for each CLR.</em></p> <p><em>The CLR version used for both .NET Framework 2.0 and .NET Framework 3.5 is CLR 2.0. There was no need in the previous two framework releases to split GAC. The problem of breaking older applications in Net Framework 4.0.</em> <p><em>To avoid issues between CLR 2.0 and CLR 4.0 , the GAC is now split into private GAC’s for each runtime.The main change is that CLR v2.0 applications now cannot see CLR v4.0 assemblies in the GAC.”</em> <p><u>Grund für die Änderung:</u> <p>For example, if both .NET 1.1 and .NET 2.0 shared the same GAC, then a .NET 1.1 application, loading an assembly from this shared GAC, could get .NET 2.0 assemblies, thereby breaking the .NET 1.1 application <p><em>“The CLR version used for both .NET Framework 2.0 and .NET Framework 3.5 is CLR 2.0. As a result of this, there was no need in the previous two framework releases to split the GAC. The problem of breaking older (in this case, .NET 2.0) applications resurfaces in Net Framework 4.0 at which point CLR 4.0 released. Hence, to avoid interference issues between CLR 2.0 and CLR 4.0, the GAC is now split into private GACs for each runtime.”</em> <p><u>Ein weiterer Punkt:</u> <p><em>“Mark Miller said... June 28, 2010 12:13 PM</em> <p><em>Thanks for the post. "Interference issues" was intentionally vague. At the time of writing, the issues were still being investigated, but it was clear there were several broken scenarios.</em> <p><em>For instance, some applications use Assemby.LoadWithPartialName to load the highest version of an assembly. If the highest version was compiled with v4, then a v2 (3.0 or 3.5) app could not load it, and the app would crash, even if there were a version that would have worked. Originally, we partitioned the GAC under it's original location, but that caused some problems with windows upgrade scenarios. Both of these involved code that had already shipped, so we moved our (version-partitioned GAC to another place.</em> <p><em>This shouldn't have any impact to most applications, and doesn't add any maintenance burden. Both locations should only be accessed or modified using the native GAC APIs, which deal with the partitioning as expected. The places where this does surface are through APIs that expose the paths of the GAC such as GetCachePath, or examining the path of mscorlib loaded into managed code.</em> <p><em>It's worth noting that we modified GAC locations when we released v2 as well when we introduced architecture as part of the assembly identity. Those added GAC_MSIL, GAC_32, and GAC_64, although all still under %windir%\assembly. Unfortunately, that wasn't an option for this release.”</em> <p>Für mich war die Nachricht ein kleiner “Aha”-Moment. Zudem wusste ich auch nicht, dass der seltsame “Assembly-Viewer” aus Windows 8 wieder entfernt wurde:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image1762.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="{{BASE_PATH}}/assets/wp-images/image_thumb916.png" width="571" height="338"></a> </p> <p><strong>Fazit:</strong></p> <p>Gut zu wissen.</p> <p><img style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px" border="0" alt="Dr. McCoy and Captain Kirk approve" src="http://gifs.gifbin.com/032010/1269602956_dr-mccoy-and-captain-kirk-approve.gif"></p>
