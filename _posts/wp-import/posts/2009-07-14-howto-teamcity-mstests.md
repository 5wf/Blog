---
layout: post
title: "HowTo: TeamCity & MSTests"
date: 2009-07-14 22:59
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [Build, Build Server, HowTo, MSTest, TeamCity, Unit Test]
---
{% include JB/setup %}
<p><a href="{{BASE_PATH}}/assets/wp-images/image803.png"><img style="border-right: 0px; border-top: 0px; margin: 0px 10px 0px 0px; border-left: 0px; border-bottom: 0px" height="96" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb781.png" width="185" align="left" border="0"></a> Automatisiert nach jedem Checkin Unit Tests laufen zu lassen ist eine der Vorzüge eines Build Servers - mit TeamCity kann man neben <a href="http://www.nunit.org/index.php">NUnit</a> Tests auch bequem <a href="{{BASE_PATH}}/2008/05/22/howto-einfache-tests-unittests-oder-keine-angst-vor-unittests/">MSTests</a> laufen lassen. Allerdings gibt es dabei ein paar Tücken.</p><p><strong>MSTest - Abhängigkeiten</strong></p> <p><a href="http://en.wikipedia.org/wiki/MSTest">MSTest</a> ist Microsofts Testframework, welches direkt in <a href="{{BASE_PATH}}/2008/05/22/howto-einfache-tests-unittests-oder-keine-angst-vor-unittests/">Visual Studio integriert</a> ist. Es hat allerdings viele Abhängigkeiten direkt zu Visual Studio. </p> <p><strong>MSTest + BuildServer</strong></p> <p>Um auf einen Build Server (<a href="{{BASE_PATH}}/2009/07/14/howto-continuous-integration-mit-teamcity/">z.B. über TeamCity</a>) MSTests laufen zu lassen, muss man entweder ein Visual Studio installieren oder man versucht <a href="http://www.shunra.com/shunrablog/index.php/2009/04/running-mstest-without-visual-studio/">diesen 20+ Schritte Leitfaden zu folgen</a>. MSTests benötigt viele Dlls und einige Registryeinträge die Visual Studio mitbringt, daher ist es nicht ohne weiteres möglich diese Tests auf einem anderen System ablaufen zu lassen.</p> <p>Wenn einen der beiden Sachen erfolgreich durchlaufen hat, kann man nun im TeamCity die passenden Einstellungen machen:</p> <p><a href="{{BASE_PATH}}/assets/wp-images/image804.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="436" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb782.png" width="513" border="0"></a> </p> <p>Ich habe hier nur die MSTest assemblies mit angegeben. Als ich das MSTest Config File angegeben habe, wollte er irgendwie nicht. Allerdings muss man die Pfade bei den assemblies wie folgt machen:</p> <div class="wlWriterSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:0406b02a-67cd-4bd3-ab8e-bf0c1f00f4ff" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="c#">%system.teamcity.build.checkoutDir%\PROJECTDIR\bin\Debug\NAME.dll</pre></div>
<p>Es können mehrere Assemblies eingegeben werden. Diese Einstellung habe ich gespeichert und nun werden auch die Unit Tests mit berücksichtigt:</p>
<p><a href="{{BASE_PATH}}/assets/wp-images/image805.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="130" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb783.png" width="244" border="0"></a> </p>
<p>Man kann sich auch auf der Weboberfläche durch die Tests hangeln und nette Statistiken bestaunen. Ich verweise wieder auf die <a href="http://teamcity.jetbrains.com/overview.html">Live Demo Seite</a> von TeamCity.</p>
<p><strong>Visual Studio auf Build Server ist böse!</strong></p>
<p>Im Prinzip ja. Leider gibt es wohl (neben der 20+ Anleitung) keinen Weg MSTest auszuführen ohne diese zu NUnit etc. zu "konvertieren" ;)<br>Lizenztechnisch ist das allerdings in einer Visual Studio Lizenz allerdings bereits abgedeckt - also falls es da bedenken gibt :)</p>
