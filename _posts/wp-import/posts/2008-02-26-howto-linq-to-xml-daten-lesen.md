---
layout: post
title: "HowTo: LINQ to XML - Daten lesen"
date: 2008-02-26 23:10
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [.NET 3.5, HowTo, LINQ, LINQ to XML, Xml]
---
{% include JB/setup %}
<p>LINQ to SQL (siehe <a href="{{BASE_PATH}}/2008/01/21/howto-or-mapper-linq-to-sql-einfhrung-in-den-designer-1n-beziehungen/">hier</a> &amp; <a href="{{BASE_PATH}}/2008/01/15/howto-or-mapper-linq-to-sql-einfhrung-einfaches-manuelles-mapping/">hier</a>) habe ich bereits behandelt, doch einer der mitgelieferten LINQ Provider wurde von mir noch vernachl&#228;ssigt: LINQ to XML.</p>  <p>Ohne LINQ kann man XML &#252;ber XPath abfragen - das ist eine nette Variante, allerdings vielleicht nicht unbedingt der Weisheits letzter Schluss.</p>  <p><strong>Fangen wir mal langsam an - hier unsere einfache XML Struktur:</strong></p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image284.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="173" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb263.png" width="244" border="0" /></a> </p>  <p> Wenn man diesen Zweig nun abrufen will, geht folgender Code:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image285.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="197" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb264.png" width="818" border="0" /></a>&#160;&#160; <br /><em>(auf meinem neuen Notebook konnte ich leider noch nicht das CodeFormatting Plugin f&#252;r den Windows Live Writer installieren - daher nur Screenshots und am Ende gibts den Source Code)</em></p>  <p><a href="http://msdn2.microsoft.com/de-de/library/system.xml.linq.xdocument.xdocument.aspx">XDocument</a> etc. ist in dem <a href="http://msdn2.microsoft.com/en-us/library/system.xml.linq.aspx">Namespace System.Xml.Linq</a> vorhanden und ist im Grund wie das <a href="http://msdn2.microsoft.com/de-de/library/system.xml.xmldocument(VS.80).aspx">XmlDokument</a> - nat&#252;rlich etwas anders. &#220;ber die Methode &quot;<a href="http://msdn2.microsoft.com/en-us/library/system.xml.linq.xdocument.descendants.aspx">Descendants</a>&quot; k&#246;nnen wir uns entweder (wie oben) manuell durch den Xml Baum hangeln, oder direkt auf das &quot;Item&quot; zugreifen:</p>  <p><a href="{{BASE_PATH}}/assets/wp-emages/image286.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="150" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb265.png" width="459" border="0" /></a> </p>  <p>Ist doch schon wesentlich eleganter, oder? Als Ergebnis bekommen wir bei dieser LINQ Abfrage die <a href="http://msdn2.microsoft.com/en-us/library/system.xml.linq.xelement.aspx">XElemente</a>:</p>
<p><a href="{{BASE_PATH}}/assets/wp-images/image287.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="150" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb266.png" width="633" border="0" /></a></p>
<p>Jeder Node hat eine &quot;Number&quot; Element, was bei dem ersten Item auf 10, beim zweiten auf 50, beim dritten auf 60 und beim vierten Item auf 70 gesetzt wurde.</p>  <p>Jetzt wollen wir nur mal alle Items heranholen, welche &#252;ber 55 liegen:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image288.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="129" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb267.png" width="721" border="0" /></a> </p>  <p>Wir navigieren uns wieder zu unseren Items und machen dann anschlie&#223;end eine Konvertierung des Values im &quot;Number&quot; Tag zu einem Integer.</p>  <p>Am Ende werden nur noch die letzten beiden Item Eintr&#228;ge angezeigt.</p>  <p><strong>Mal etwas komplizierter - Attribute, Verschachtelungen &amp; Abfragen:</strong></p>  <p>Unsere etwas komplexere XML Struktur:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image289.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="257" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb268.png" width="266" border="0" /></a> </p>  <p>Mit dieser LINQ Abfrage bekommt man alle komplexen Items, welche als Attribut &quot;marketplace&quot; &quot;fr&quot; haben und die Number gr&#246;&#223;er als 20 ist:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image290.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="120" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb269.png" width="558" border="0" /></a> </p>  <p><strong>Fazit:</strong></p>  <p>LINQ to XML ist eine schicke Alternative zu normalen XPath und erlaubt sehr viele Spielerein. Wenn ich zeit finde, zeige ich auch noch, wie man XML Dokumente bearbeitet. Man kann das ganze nat&#252;rlich noch weitertreiben. In dem select Statement kann man sich seine eigenen Datentypen erstellen etc. (<a href="{{BASE_PATH}}/2008/01/13/howto-c-30-var-keyword-und-andere-kleine-c-30-features-verstehen/">dank an das Zauberwort &quot;var&quot;)</a>.</p>  <p>Insbesondere f&#252;r diejenigen, welche einen RSS/Atom Feedreader entwickeln wollen, sollten mal auf LINQ to XML einen Blick werfen.</p>  <p>Hier einen weiterf&#252;hrenden Link:</p>  <ul>   <li><a href="http://www.hookedonlinq.com/Default.aspx?Page=LINQtoXML5MinuteOverview&amp;AspxAutoDetectCookieSupport=1">LINQ to XML - 5 Minute Overview</a></li> </ul>  <p><strong><a href="{{BASE_PATH}}/assets/files/democode/linqtoxml/linqtoxml.zip">[ Download Source Code ]</a></strong></p>
