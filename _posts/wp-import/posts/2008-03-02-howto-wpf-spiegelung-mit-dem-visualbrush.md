---
layout: post
title: "HowTo: WPF Spiegelung mit dem VisualBrush"
date: 2008-03-02 23:59
author: robert.muehsig
comments: true
categories: [HowTo]
tags: [.NET 3.5, Databinding, Expression, Expression Blend, HowTo, UI, Visual Studio 2008, WPF]
language: de
---
{% include JB/setup %}
<p>Vor einige Zeit hatte ich ein Silverlight HowTo geschrieben, in dem es um den bekannten &quot;<a href="{{BASE_PATH}}/artikel/howto-microsoft-silverlight-10-bilder-kippen-samt-spiegeleffekte/">Spiegeleffekt</a>&quot; ging. </p>  <p>Im Prinzip habe ich das &quot;Hauptobjekt&quot; geklont und entsprechend ver&#228;ndert, damit ein Spiegelungseffekt auftritt. Allerdings bietet WPF noch eine andere M&#246;glichkeit (vielleicht sogar noch mehr...) und zwar &#252;ber den &quot;<a href="http://msdn2.microsoft.com/de-de/library/system.windows.media.visualbrush.aspx">VisualBrush</a>&quot;.</p>  <p>Wer noch nicht so bewandert mit WPF ist: Ein Brush repr&#228;sentiert den &quot;Anstrich&quot; eines Objektes. Es gibt verschiedene Brushs, aber dazu sollte man lieber die <a href="http://msdn2.microsoft.com/en-us/library/aa970904.aspx">MSDN kontaktieren</a>.</p>  <p><strong>Schritt 1: Fangen wir mal langsam an: WPF Projekt &amp; Bild suchen</strong></p>  <p>Wir wollen eine einfache Spiegelung eines Bildes (im meinem Fall ein Windows Standardbild) in einer WPF Anwendung.</p>  <p>Dazu legen wir ein WPF Projekt an - ich mach dies in diesem Fall mit Expression Blend, theoretisch geht es nat&#252;rlich auch in Visual Studio):</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image301.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="156" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb280.png" width="244" border="0" /></a> </p>  <p>... und holen uns noch ein entsprechendes Bild:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image302.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="191" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb281.png" width="244" border="0" /></a> </p>  <p><strong>Schritt 2: Das Spiegel vorbereiten</strong></p>  <p>Am Anfang haben wir ein wei&#223;e Arbeitsfl&#228;che vor uns - diese wollen wir nun mit dem Bild bef&#252;llen:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image303.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="222" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb282.png" width="538" border="0" /></a> </p>  <p>In dem &quot;<a href="http://msdn2.microsoft.com/en-us/library/system.windows.controls.grid.aspx">Grid</a>&quot; wird noch ein &quot;<a href="http://msdn2.microsoft.com/en-us/library/system.windows.controls.stackpanel.aspx">StackPanel</a>&quot; geschrieben, welches ein &quot;<a href="http://msdn2.microsoft.com/de-de/library/system.windows.controls.border.aspx">Border</a>&quot;-Element mit einem &quot;<a href="http://msdn2.microsoft.com/de-de/library/system.windows.controls.border.aspx">Image</a>&quot; beinhaltet.</p>  <p>Ergebnis:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image304.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="188" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb283.png" width="244" border="0" /></a> </p>  <p><strong>Schritt 3: Das Bild duplizieren</strong></p>  <p>Jetzt kommt das gro&#223;e Geheimnis - der Einsatz des VisualBrush:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image305.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="164" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb284.png" width="472" border="0" /></a> </p>  <p>Der rosa umrahmte Teil wird zur Spiegelung. &#220;ber die Background Property setzen wir den Visual Brush auf unser originales Bild. Das ganze kann man dem Themengebiet <a href="http://msdn2.microsoft.com/en-us/library/ms750612.aspx">Databinding</a> zuordnen.</p>  <p>Ergebnis:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image306.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="244" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb285.png" width="169" border="0" /></a> </p>  <p><strong>Schritt 4: Das Bild spiegeln</strong></p>  <p>Das tats&#228;chliche spiegeln erreichen wir &#252;ber ein &quot;<a href="http://msdn2.microsoft.com/de-de/library/system.windows.media.scaletransform.aspx">ScaleTransform</a>&quot;:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image307.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="107" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb286.png" width="489" border="0" /></a></p>  <p> Ergebnis:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image308.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="244" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb287.png" width="169" border="0" /></a> </p>  <p><strong>Schritt 5: Durchsichtigkeit in der Spiegelung</strong></p>  <p>Eine Spiegelung setzt immer eine gewisse &quot;durchsichtigkeit&quot; im Verlauf voraus - ansonsten hat man diesen Effekt nicht.   <br />Dies ist &#252;ber die &quot;<a href="http://msdn2.microsoft.com/en-us/library/ms532910(VS.85).aspx">Opacity</a>&quot; Property &amp; &quot;<a href="http://msdn2.microsoft.com/en-us/library/ms532910(VS.85).aspx">Opacity</a>&quot; Mask m&#246;glich:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image309.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="228" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb288.png" width="472" border="0" /></a> </p>  <p>Ergebnis:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image310.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="244" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb289.png" width="155" border="0" /></a> </p>  <p><strong>Fertig</strong></p>  <p>Wenn man nun noch f&#252;r den Hintergrund einen netten Farbverlauf einspielt, bekommt man sowas:</p>  <p><a href="{{BASE_PATH}}/assets/wp-images/image311.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="359" alt="image" src="{{BASE_PATH}}/assets/wp-images/image-thumb290.png" width="288" border="0" /></a> </p>  <p>Das ganze k&#246;nnt ihr nat&#252;rlich ganz unten downloaden.</p>  <p><strong>Quellen</strong></p>  <p>Ich geb zu - in diesem Fall war ich wenig kreativ. Ich habe diesen <a href="http://www.xamlog.com/2006/07/30/reflection-using-visual-brush-and-opacity-mask/">Blogeintrag</a> gefunden, welcher im Prinzip genau dasselbe macht. Ich hab einige Verlinkungen bei mir hinzugef&#252;gt und es einfach mal selber ausprobiert :)</p>  <p>In der MSDN gibt es auch noch ein anderes Beispiel, allerdings war mir dies zu komplex, zeigt aber, was der VisualBrush alles kann: <a href="http://msdn2.microsoft.com/en-us/library/aa970263.aspx">How to: Create a Reflection</a></p>  <p>Wer &#252;ber die Performance nachdenkt, insbesondere in 3D Anwendungen, sollte diese beiden Seiten durchlesen:</p>  <ul>   <li><a href="http://msdn2.microsoft.com/en-us/library/bb613553.aspx">Maximize WPF 3D Performance</a></li>    <li><a href="http://msdn2.microsoft.com/en-us/library/aa970776.aspx">Performance</a></li> </ul>  <p><strong><a href="{{BASE_PATH}}/assets/files/democode/simplereflection/simplereflection.zip">[ Download Democode ]</a></strong></p>
