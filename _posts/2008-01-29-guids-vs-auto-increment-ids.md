---
layout: post
title: "GUIDs vs. auto-increment IDs"
date: 2008-01-29 21:20
author: robert.muehsig
comments: true
categories: [Allgemein]
tags: [.NET 3.5, LINQ, LINQ to SQL, SQL Server]
---
<p>Ich oute mich mal als ein "ehemaliger" PHP Entwickler. MySQL ist natürlich die Standarddatenbank für PHP Anwendungen. Man macht über phpmyadmin (ich war noch jung und kannte nichts anderes ;) ) seine Datenbanken und wie es sich so gehört, hat jeder Datensatz in einer X-beliebigen Tabelle eine eindeutige ID. Die "ID" Spalte wird einfach ein Integer und setzt diese als den primären Schlüssel und schaltet noch ein, dass diese Spalte automatisch hochgezählt werden soll.</p> <p>So für sich gesehen, ist es recht simpel und funktioniert gut. Dieses Prinzip wird aber dann schwieriger umzusetzen, wenn bestimmte Abhängigkeiten zu anderen Tabellen bestehen sollen.</p> <p><strong>Aber erstmal ganz langsam... unser Szenario:</strong></p> <p>Wir haben Produkte, welche wir in eine "Products" Tabelle speichern:</p> <ul> <li>Id</li> <li>Name</li> <li>Price</li></ul> <p>Jedes Produkt kann ähnliche Produkte haben, welche in einer "ReleatedProducts" Tabelle gespeichert wird:</p> <ul> <li>Id (diese Spalte könnte man auch weglassen - spielt aber jetzt keine große Rolle).</li> <li>ProductFirstId</li> <li>ProductSecondId</li></ul> <p>Wir haben jetzt ein Anwendung, in dem wir 2 Produkte erstellen wollen und diese in Beziehung setzen. Wenn wir dies jetzt mit "normalen" autoincrement IDs umsetzen, wird es etwas knifflig...</p> <p><strong>Warum? Das geht ganz einfach...</strong></p> <p>Natürlich geht das mit dem autoincrement IDs. Allerdings muss man quasi folgende Schritte machen:</p> <ol> <li>Erstes Produkt erstellen</li> <li>Erstelltes Produkt in die DB speichern</li> <li>Eben erstellte ID als Rückgabewert bekommen</li> <li>Zweites Produkt erstellen</li> <li>Erstelltes Produkt in die DB speichern</li> <li>Eben erstelle ID als Rückgabewert bekommen</li> <li>Beziehung setzen mit den beiden Rückgabewerten</li></ol> <p>Das ist nur teilweise schön - das liegt nunmal an der Natur von autoincrement IDs:</p> <p><strong><u>Die Verwaltung der eindeutigen IDs wird der Datenbank überlassen!</u></strong></p> <p>Man kann nicht 100% die nächste ID erraten. Wenn man nun einen Datensatz mit einem anderen Verknüpfen möchte, muss man vorher immer die DB befragen. Falls in der Zwischenzeit was schief geht und auch keine <a href="http://de.wikipedia.org/wiki/Referenzielle_Integrit%C3%A4t" target="_blank">referenzielle Integrität</a> angeschaltet ist, bleiben im schlimmsten Falle leichen übrig.</p> <p><strong>Was gibts für eine Alternative?</strong></p> <p><a href="http://de.wikipedia.org/wiki/Globally_Unique_Identifier" target="_blank">GUIDs</a> bieten eine nette Abhilfe und sind insbesondere im Microsoft Umfeld stark vertreten. </p> <p>Im .NET Framework gibt es direkt eine <a href="http://msdn2.microsoft.com/en-us/library/system.guid(VS.71).aspx" target="_blank">GUID Klasse</a> zum Erzeugen solcher IDs. Im SQL Server ist der Datentyp "<strong>uniqueidentifer</strong>" dafür vorgesehen.</p> <p><strong>Was sind die Vorteile?</strong></p> <ul> <li>Die Kontrolle der eindeutigen IDs kann direkt im Programm gesteuert werden.</li> <li>Die Daten brauchen erst zur DB gespeichert werden, wenn dies nötig ist.</li> <li>Bei einer evtl. Zusammenführung von 2 Tabellen hat man das ID Problem nicht.</li></ul> <p><strong>Was sind die Nachteile?</strong></p> <ul> <li>Performance? Jedenfalls aus dem Microsoft SQL Lager hört man sowas nicht - zwar ist eine GUID länger als eine "normale" ID, allerdings fällt dies kaum ins Gewicht.</li> <li>Ids sind etwas unschöner und man kann schlechter nachvollziehen und mal einzelne Daten Testen:</li> <ul> <li>Webseiten mit ...?id=2312 sind (wie z.B. bei Wordpress) durch konkrete Titel ersetzt wurden - die IDs "sieht" der Benutzer (oder die Suchmaschine) kaum. Das man einzelne Daten schlechter Nachverfolgen kann, ist allerdings wahr.</li></ul></ul> <p><strong>Demoprojekt nötig?</strong></p> <p> Ich habe ein Demoprojekt mit VS 2008 Express Edition und LINQ to SQL erstellt - dort wird einmal mit GUIDs und ohne GUIDs gearbeitet - allerdings habe ich nur den GUID Teil bis zum Ende geführt - weil es für mich simpler war ;)</p> <p>Der ConnectionString muss natürlich angefasst werden:</p> <p><a href="http://{{BASE_PATH}}/assets/files/democode/guidvsid/guidvsid.zip" target="_blank">[ Download Democode ]</a></p>
